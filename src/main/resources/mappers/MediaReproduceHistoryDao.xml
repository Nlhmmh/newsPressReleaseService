<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jp.sense.pr.dao.MediaReproduceHistoryDao">
	<resultMap id="BaseResultMap"
		type="com.jp.sense.pr.model.entity.MediaReproduceHistory">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="RELEASE_ID" jdbcType="INTEGER" property="releaseId" />
		<id column="MEDIA_USER_ID" jdbcType="INTEGER"
			property="mediaUserId" />
		<result column="URL" jdbcType="VARCHAR" property="url" />
		<result column="DELETE_FLAG" jdbcType="VARCHAR"
			property="deleteFlag" />
		<result column="CREATE_USER" jdbcType="VARCHAR"
			property="createUser" />
		<result column="CREATE_DATETIME" jdbcType="TIMESTAMP"
			property="createDatetime" />
		<result column="UPDATE_USER" jdbcType="VARCHAR"
			property="updateUser" />
		<result column="UPDATE_DATETIME" jdbcType="TIMESTAMP"
			property="updateDatetime" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		RELEASE_ID, MEDIA_USER_ID, URL, DELETE_FLAG, CREATE_USER,
		CREATE_DATETIME, UPDATE_USER,
		UPDATE_DATETIME
	</sql>
	<select id="selectByPrimaryKey" parameterType="map"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select
		<include refid="Base_Column_List" />
		from media_reproduce_history
		where RELEASE_ID = #{releaseId,jdbcType=INTEGER}
		and MEDIA_USER_ID = #{mediaUserId,jdbcType=INTEGER}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from media_reproduce_history
		where RELEASE_ID = #{releaseId,jdbcType=INTEGER}
		and MEDIA_USER_ID = #{mediaUserId,jdbcType=INTEGER}
	</delete>
	<insert id="insert"
		parameterType="com.jp.sense.pr.model.entity.MediaReproduceHistory">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into media_reproduce_history (RELEASE_ID, MEDIA_USER_ID, URL,
		DELETE_FLAG, CREATE_USER, CREATE_DATETIME,
		UPDATE_USER, UPDATE_DATETIME)
		values (#{releaseId,jdbcType=INTEGER}, #{mediaUserId,jdbcType=INTEGER},
		#{url,jdbcType=VARCHAR},
		#{deleteFlag,jdbcType=VARCHAR}, #{createUser,jdbcType=VARCHAR}, #{createDatetime,jdbcType=TIMESTAMP},
		#{updateUser,jdbcType=VARCHAR}, #{updateDatetime,jdbcType=TIMESTAMP})
	</insert>
	<insert id="insertSelective"
		parameterType="com.jp.sense.pr.model.entity.MediaReproduceHistory">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into media_reproduce_history
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="releaseId != null">
				RELEASE_ID,
			</if>
			<if test="mediaUserId != null">
				MEDIA_USER_ID,
			</if>
			<if test="url != null">
				URL,
			</if>
			<if test="deleteFlag != null">
				DELETE_FLAG,
			</if>
			<if test="createUser != null">
				CREATE_USER,
			</if>
			<if test="createDatetime != null">
				CREATE_DATETIME,
			</if>
			<if test="updateUser != null">
				UPDATE_USER,
			</if>
			<if test="updateDatetime != null">
				UPDATE_DATETIME,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="releaseId != null">
				#{releaseId,jdbcType=INTEGER},
			</if>
			<if test="mediaUserId != null">
				#{mediaUserId,jdbcType=INTEGER},
			</if>
			<if test="url != null">
				#{url,jdbcType=VARCHAR},
			</if>
			<if test="deleteFlag != null">
				#{deleteFlag,jdbcType=VARCHAR},
			</if>
			<if test="createUser != null">
				#{createUser,jdbcType=VARCHAR},
			</if>
			<if test="createDatetime != null">
				#{createDatetime,jdbcType=TIMESTAMP},
			</if>
			<if test="updateUser != null">
				#{updateUser,jdbcType=VARCHAR},
			</if>
			<if test="updateDatetime != null">
				#{updateDatetime,jdbcType=TIMESTAMP},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective"
		parameterType="com.jp.sense.pr.model.entity.MediaReproduceHistory">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update media_reproduce_history
		<set>
			<if test="url != null">
				URL = #{url,jdbcType=VARCHAR},
			</if>
			<if test="deleteFlag != null">
				DELETE_FLAG = #{deleteFlag,jdbcType=VARCHAR},
			</if>
			<if test="createUser != null">
				CREATE_USER = #{createUser,jdbcType=VARCHAR},
			</if>
			<if test="createDatetime != null">
				CREATE_DATETIME = #{createDatetime,jdbcType=TIMESTAMP},
			</if>
			<if test="updateUser != null">
				UPDATE_USER = #{updateUser,jdbcType=VARCHAR},
			</if>
			<if test="updateDatetime != null">
				UPDATE_DATETIME = #{updateDatetime,jdbcType=TIMESTAMP},
			</if>
		</set>
		where RELEASE_ID = #{releaseId,jdbcType=INTEGER}
		and MEDIA_USER_ID = #{mediaUserId,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey"
		parameterType="com.jp.sense.pr.model.entity.MediaReproduceHistory">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update media_reproduce_history
		set URL = #{url,jdbcType=VARCHAR},
		DELETE_FLAG = #{deleteFlag,jdbcType=VARCHAR},
		CREATE_USER = #{createUser,jdbcType=VARCHAR},
		CREATE_DATETIME = #{createDatetime,jdbcType=TIMESTAMP},
		UPDATE_USER = #{updateUser,jdbcType=VARCHAR},
		UPDATE_DATETIME = #{updateDatetime,jdbcType=TIMESTAMP}
		where RELEASE_ID = #{releaseId,jdbcType=INTEGER}
		and MEDIA_USER_ID = #{mediaUserId,jdbcType=INTEGER}
	</update>





	<select id="selectByComId"
		resultType="com.jp.sense.pr.model.entity.PressRelease">

		select
		pr.id as id,
		pr.release_title as releaseTitle,
		pr.create_datetime as createDatetime
		FROM
		media_reproduce_history mrh
		LEFT JOIN press_release pr ON mrh.RELEASE_ID = pr.id
		LEFT JOIN company com ON pr.BUSINESS_ID=com.id
		WHERE
		mrh.delete_flag = '0' AND
		pr.delete_flag = '0' AND
		com.delete_flag = '0' AND
		com.id = #{arg0,jdbcType=VARCHAR}
		ORDER BY
		createDatetime DESC
		LIMIT 0, #{arg1,jdbcType=VARCHAR}
	</select>


	<select id="selectOnlineMediaDitailList"
		resultType="com.jp.sense.pr.model.dto.MediaReproduceHistoryDTO">
		SELECT
		pr.release_title as releaseTitle,
		media.medium_name as mediumName,
		media.medium_company_name as mediumCompanyName,
		rephist.url as url,
		pr.id as prId,
		media.id as mediaId
		FROM
		media_reproduce_history rephist
		LEFT OUTER JOIN media_user media
		ON (rephist.media_user_id = media.id AND media.delete_flag = '0')
		LEFT OUTER JOIN press_release pr ON (rephist.release_id = pr.id AND
		pr.release_status = '2'
		AND pr.published_date &lt; now() AND pr.delete_flag = '0')
		WHERE
		rephist.delete_flag = '0' AND rephist.release_id = #{arg0,jdbcType=VARCHAR}
		ORDER BY rephist.create_datetime ASC
	</select>




</mapper>